var X=Object.defineProperty,Z=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var P=(s,n,o)=>n in s?X(s,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[n]=o,d=(s,n)=>{for(var o in n||(n={}))te.call(n,o)&&P(s,o,n[o]);if(A)for(var o of A(n))ae.call(n,o)&&P(s,o,n[o]);return s},g=(s,n)=>Z(s,ee(n));import{c as re,j as a,d as ne,e as se}from"./index-Dz65CAxN.js";import{d as oe,e as le,r as y}from"./router-vendor-BfUoC7-o.js";import{u as ie,G as ce,M as ue}from"./useWelcomeModal-CPqjDDpd.js";import{u as me}from"./useDailySeed-CCpBxUz8.js";import"./react-vendor-C0DUGSOM.js";import"./helmet-vendor-CTOi22zu.js";import"./index-C9qaKABp.js";const G={secretEquation:"",currentRow:0,currentCol:0,gameOver:!1,gameWon:!1,maxAttempts:6,equationLength:8,board:Array.from({length:6},()=>Array.from({length:8},()=>({value:"",status:""}))),keypadColors:{}},L=["Great Job!","Awesome!","You did it!","Impressive!","Fantastic!","Well done!","You cracked it!","Brilliant!","Superb!","You nailed it!"],de=["+","-","*","/","="];function I(){const s=["1+2*3=7","4+5-2=7","3*4/2=6","8-3+1=6","2*3+1=7","9-4*1=5","6/2+3=6","5+1*2=7","7-2+1=6","4*2-1=7"];return s[Math.floor(Math.random()*s.length)]}function B(){return Array.from({length:6},()=>Array.from({length:8},()=>({value:"",status:""})))}function w(s){function n(b){let h=0;for(let k=0;k<b.length;k++)h=(h<<5)-h+b.charCodeAt(k),h|=0;let i=Math.abs(h)/2147483647;return()=>(i=Math.sin(i*1e4)*1e4,i-Math.floor(i))}const o=["1+2*3=7","4+5-2=7","3*4/2=6","8-3+1=6","2*3+1=7","9-4*1=5","6/2+3=6","5+1*2=7","7-2+1=6","4*2-1=7"],v=n(s);return o[Math.floor(v()*o.length)]}function ge(s){try{if((s.match(/=/g)||[]).length!==1)return!1;const n=s.split("=");if(n.length!==2)return!1;const o=n[0],v=n[1];if(!/^\d+$/.test(v))return!1;const b=parseInt(v,10);if(isNaN(b)||!Number.isInteger(b)||!/^[\d+\-*/]+$/.test(o))return!1;const i=new Function("return "+o)();return isNaN(i)||!Number.isInteger(i)?!1:i===b}catch(n){return!1}}const Ne=({mode:s,description:n,instructions:o})=>{const v=oe(),b=le(),i=new URLSearchParams(b.search).get("mode")==="daily",k=new Date().toISOString().slice(0,10),p=me({date:k,slug:"numberle"}),[e,x]=y.useState(()=>{const t=i&&p?w(p):I();return g(d({},G),{secretEquation:t,board:B()})}),[f,D]=y.useState(()=>re()),[T,q]=y.useState(!1),[F,Y]=y.useState({won:!1,message:""}),[E,C]=y.useState(""),[_,K]=y.useState(0),{WelcomeModal:U,gameContainerRef:J}=ie("Numberle",o);y.useEffect(()=>{i&&p&&e.secretEquation!==w(p)&&x(t=>g(d({},t),{secretEquation:w(p)}))},[i,p,e.secretEquation]);const N=t=>{if(e.gameOver||e.currentCol>=e.equationLength)return;const l=[...e.board];l[e.currentRow][e.currentCol]={value:t,status:"filled"},x(g(d({},e),{board:l,currentCol:e.currentCol+1}))},j=()=>{if(e.gameOver||e.currentCol===0)return;const t=[...e.board];t[e.currentRow][e.currentCol-1]={value:"",status:""},x(g(d({},e),{board:t,currentCol:e.currentCol-1}))},R=()=>{if(e.gameOver||e.currentCol!==e.equationLength)return;const t=e.board[e.currentRow].map(m=>m.value).join("");if(console.log("Submitting guess:",t),console.log("Secret equation:",e.secretEquation),!ge(t)){C("Please enter a valid equation (e.g., 1+2*3=7)");return}const l=H(t,e.secretEquation);console.log("Feedback:",l);const c=[...e.board];for(let m=0;m<e.equationLength;m++)c[e.currentRow][m]=g(d({},c[e.currentRow][m]),{status:l[m]});const u=d({},e.keypadColors);for(let m=0;m<e.equationLength;m++){const $=t[m],M=l[m];(!u[$]||M==="correct")&&(u[$]=M)}const r=t===e.secretEquation,S=r||e.currentRow===e.maxAttempts-1,O=g(d({},e),{board:c,currentRow:S?e.currentRow:e.currentRow+1,currentCol:0,gameOver:S,gameWon:r,keypadColors:u});x(O),C(""),S&&V(O)},V=t=>{q(!0),Y({won:t.gameWon,message:L[_]}),K(c=>(c+1)%L.length);const l=g(d({},f),{gamesPlayed:f.gamesPlayed+1,gamesWon:t.gameWon?f.gamesWon+1:f.gamesWon,currentStreak:t.gameWon?f.currentStreak+1:0,bestStreak:t.gameWon?Math.max(f.bestStreak,f.currentStreak+1):f.bestStreak});D(l),ne(l),i&&t.gameWon&&se("numberle",{date:k,completed:!0,result:{}})},W=()=>{x(g(d({},G),{secretEquation:i?w(p):I(),board:B()})),q(!1),C("")},z=t=>{e.gameOver||(t.key>="0"&&t.key<="9"?N(t.key):t.key==="Enter"?R():t.key==="Backspace"?j():["+","-","*","/","="].includes(t.key)&&N(t.key))},H=(t,l)=>{const c=Array(8).fill("absent"),u={};for(let r=0;r<8;r++)u[l[r]]=(u[l[r]]||0)+1;for(let r=0;r<8;r++)t[r]===l[r]&&(c[r]="correct",u[t[r]]--);for(let r=0;r<8;r++)c[r]!=="correct"&&u[t[r]]>0&&(c[r]="present",u[t[r]]--);return c},Q=()=>e.gameOver?e.gameWon?"Congratulations! You won the game!":`Game over. The equation was ${e.secretEquation}`:`Attempt ${e.currentRow+1} of ${e.maxAttempts}, ${e.currentCol} characters entered`;return a.jsxs(ce,{children:[a.jsx(U,{}),a.jsxs("div",{className:"game-container",ref:J,onKeyDown:z,tabIndex:0,role:"application","aria-label":"Numberle game","aria-live":"polite","aria-atomic":"true",style:{outline:"2px solid transparent"},onFocus:t=>t.target.style.outline="2px solid #007bff",onBlur:t=>t.target.style.outline="2px solid transparent",children:[a.jsx("div",{className:"sr-only","aria-live":"polite",children:Q()}),a.jsx("div",{className:"board",role:"grid","aria-label":"Numberle game board",children:e.board.map((t,l)=>a.jsx("div",{className:`row ${l===e.currentRow?"current":""}`,role:"row","aria-label":`Row ${l+1}`,children:t.map((c,u)=>a.jsx("div",{className:`tile ${c.status} ${l===e.currentRow&&u===e.currentCol?"current":""}`,role:"gridcell","aria-label":`Position ${u+1}, ${c.value||"empty"}`,tabIndex:0,children:c.value},u))},l))}),E&&a.jsx("div",{className:"message",role:"alert","aria-live":"assertive",children:E}),a.jsxs("div",{className:"keypad-container",children:[a.jsx("div",{className:"number-row",role:"group","aria-label":"Number keys",children:[1,2,3,4,5,6,7,8,9,0].map(t=>a.jsx("button",{className:`key-btn number-btn ${e.keypadColors[t]||""}`,onClick:()=>N(t.toString()),disabled:e.gameOver,"aria-label":`Enter digit ${t}`,tabIndex:0,children:t},t))}),a.jsxs("div",{className:"action-row",role:"group","aria-label":"Operator and action keys",children:[a.jsx("button",{className:"key-btn action-btn",onClick:j,disabled:e.gameOver,"aria-label":"Delete last character",tabIndex:0,children:"âŒ«"}),de.map(t=>a.jsx("button",{className:`key-btn operator-btn ${e.keypadColors[t]||""}`,onClick:()=>N(t),disabled:e.gameOver,"aria-label":`Enter operator ${t}`,tabIndex:0,children:t},t)),a.jsx("button",{className:`key-btn action-btn ${e.currentCol===e.equationLength?"active":""}`,onClick:R,disabled:e.gameOver||e.currentCol!==e.equationLength,"aria-label":"Submit equation",tabIndex:0,children:"Enter"})]})]})]}),a.jsx(ue,{open:T,onClose:W,title:e.gameWon?"Congratulations!":"Game Over",className:"endgame-modal",buttons:a.jsxs("div",{className:"endgame-buttons",children:[a.jsx("button",{className:"playagain-btn",onClick:W,"aria-label":"Play again",children:"Play Again"}),a.jsx("button",{className:"backhome-btn",onClick:()=>v("/"),"aria-label":"Back to games",children:"Back to Games"})]}),children:a.jsxs("div",{className:"endgame-content",children:[a.jsx("p",{className:"endgame-message",children:F.message}),!e.gameWon&&a.jsxs("p",{className:"endgame-equation",children:["The equation was: ",e.secretEquation]})]})})]})};export{Ne as default};
