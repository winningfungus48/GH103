var ee=Object.defineProperty,te=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var E=(r,n,t)=>n in r?ee(r,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[n]=t,v=(r,n)=>{for(var t in n||(n={}))ae.call(n,t)&&E(r,t,n[t]);if(U)for(var t of U(n))re.call(n,t)&&E(r,t,n[t]);return r},P=(r,n)=>te(r,se(n));var Y=(r,n,t)=>new Promise((i,k)=>{var y=c=>{try{u(t.next(c))}catch(m){k(m)}},l=c=>{try{u(t.throw(c))}catch(m){k(m)}},u=c=>c.done?i(c.value):Promise.resolve(c.value).then(y,l);u((t=t.apply(r,n)).next())});import{f as K,m as ne,n as oe,j as o}from"./index-ChlTwkeS.js";import{r as a,u as le,e as ce}from"./router-vendor-K3Txs3ma.js";import{u as ie,G as ue}from"./useWelcomeModal-BE67pmST.js";import{u as me}from"./useDailySeed-BCululcd.js";import{M as de}from"./Modal-BytEiDWw.js";import"./react-vendor-C0DUGSOM.js";import"./helmet-vendor-DAr0CUAT.js";import"./index-C9qaKABp.js";const fe="_gameContainer_50k6s_1",ge="_gameInfo_50k6s_21",pe="_scoreDisplay_50k6s_37",he="_dailyMode_50k6s_53",ve="_gameBoard_50k6s_73",ke="_patternIndicator_50k6s_91",ye="_colorGrid_50k6s_115",Ce="_colorButton_50k6s_137",be="_active_50k6s_181",_e="_clickable_50k6s_195",Pe="_patternPlayback_50k6s_225",Se="_gameControls_50k6s_247",xe="_startButton_50k6s_259",we="_playAgainButton_50k6s_261",Be="_modalContent_50k6s_335",je="_stats_50k6s_357",Te="_modalButtons_50k6s_383",f={gameContainer:fe,gameInfo:ge,scoreDisplay:pe,dailyMode:he,gameBoard:ve,patternIndicator:ke,colorGrid:ye,colorButton:Ce,active:be,clickable:_e,patternPlayback:Pe,gameControls:Se,startButton:xe,playAgainButton:we,modalContent:Be,stats:je,modalButtons:Te};function We(r,n={}){const{storageKey:t,persist:i=!1,serialize:k=JSON.stringify,deserialize:y=JSON.parse,validate:l=()=>!0,debounceMs:u=1e3}=n,[c,m]=a.useState(r),[d,e]=a.useState(!1),[g,w]=a.useState(!1),p=a.useRef(null),T=a.useRef(null);a.useEffect(()=>{if(i&&t)try{const h=localStorage.getItem(t);if(h){const S=y(h);l(S)&&(m(S),e(!0),p.current=S)}}catch(h){console.warn(`Failed to load persisted state for key: ${t}`)}},[i,t,y,l]);const b=a.useCallback(h=>{!i||!t||(T.current&&clearTimeout(T.current),T.current=setTimeout(()=>{try{const S=k(h);localStorage.setItem(t,S),p.current=h,e(!0),w(!1)}catch(S){console.warn(`Failed to save state for key: ${t}`)}},u))},[i,t,k,u]),_=a.useCallback(h=>{m(S=>{const R=typeof h=="function"?h(S):h;return w(!0),b(R),R})},[b]),W=a.useCallback(()=>{if(m(r),w(!1),e(!1),i&&t)try{localStorage.removeItem(t)}catch(h){console.warn(`Failed to clear persisted state for key: ${t}`)}},[r,i,t]),$=a.useCallback(h=>{_(S=>v(v({},S),h))},[_]),I=a.useCallback(()=>{if(i&&t)try{localStorage.removeItem(t),e(!1),w(!1),p.current=null}catch(h){console.warn(`Failed to clear persisted state for key: ${t}`)}},[i,t]);return a.useEffect(()=>()=>{T.current&&clearTimeout(T.current)},[]),{state:c,setState:_,resetState:W,updateState:$,clearPersistedState:I,isPersisted:d,hasChanges:g}}function Me(r,n,t={}){const{onComplete:i,gameSlug:k,trackStats:y=!0,trackStreak:l=!0,getResult:u=()=>({completed:!0,result:"completed"}),validateCompletion:c=()=>!0}=t,m=a.useRef(!1),d=a.useRef({isCompleted:!1,completedAt:null,result:null,dailyStreak:0}),e=a.useCallback(b=>n(b)&&c(b),[n,c]),g=a.useCallback(b=>{if(m.current)return;const _=u(b),W=new Date,$=W.toISOString().slice(0,10);if(d.current={isCompleted:!0,completedAt:W,result:_,dailyStreak:0},y&&k)try{if(l){const I=K(k,{date:$,completed:_.completed,result:_});I&&(d.current.dailyStreak=I.streak)}}catch(I){console.warn(`Failed to track completion statistics for ${k}`)}m.current=!0,i&&i(b,d.current)},[i,k,y,l,u]),w=a.useCallback(()=>{m.current=!1,d.current={isCompleted:!1,completedAt:null,result:null,dailyStreak:0}},[]),p=a.useCallback((b=null)=>{if(m.current)return;const _=b||u(r),W=new Date;d.current={isCompleted:!0,completedAt:W,result:_,dailyStreak:0},m.current=!0,i&&i(r,d.current)},[r,i,u]);a.useEffect(()=>{!m.current&&e(r)?g(r):m.current&&!n(r)&&w()},[r,e,g,n,w]);const T=a.useCallback(()=>v({},d.current),[]);return{isCompleted:d.current.isCompleted,completionStats:T(),resetCompletion:w,forceComplete:p}}const F={pattern:[],userPattern:[],currentIndex:0,isPlaying:!1,isUserTurn:!1,gameOver:!1,gameWon:!1,score:0,level:1,maxLevel:20,activeButton:null,showPattern:!1},Ie=[{id:0,name:"green",color:"#10b981",borderColor:"#059669"},{id:1,name:"red",color:"#ef4444",borderColor:"#dc2626"},{id:2,name:"orange",color:"#f97316",borderColor:"#ea580c"},{id:3,name:"blue",color:"#3b82f6",borderColor:"#2563eb"}],z=["Great Job!","Awesome!","You did it!","Impressive!","Fantastic!","Well done!","You cracked it!","Brilliant!","Superb!","You nailed it!"],J=["Better luck next time!","Don't give up!","Try again tomorrow!","Keep practicing!","You'll get it next time!"];function A(r,n){const i=(y=>{let l=0;for(let c=0;c<y.length;c++)l=(l<<5)-l+y.charCodeAt(c),l|=0;let u=Math.abs(l)/2147483647;return()=>(u=Math.sin(u*1e4)*1e4,u-Math.floor(u))})(r),k=[];for(let y=0;y<n;y++)k.push(Math.floor(i()*4));return k}function D(r){const n=[];for(let t=0;t<r;t++)n.push(Math.floor(Math.random()*4));return n}const Ee=({mode:r,description:n,instructions:t})=>{const i=le(),k=ce(),l=new URLSearchParams(k.search).get("mode")==="daily",u=new Date().toISOString().slice(0,10),c=me({date:u,slug:"simonle"}),m=a.useRef([]),d=a.useRef(!0),{state:e,setState:g,resetState:w}=We(P(v({},F),{pattern:l?A(c,1):D(1)}),{persist:!0,storageKey:`simonle-${l?"daily":"practice"}-${u}`}),[p,T]=a.useState(()=>ne()),[b,_]=a.useState(!1),[W,$]=a.useState({won:!1,message:""}),[I,h]=a.useState(0),{WelcomeModal:S}=ie("Simonle",t),R=a.useCallback(()=>{m.current.forEach(s=>clearTimeout(s)),m.current=[]},[]),N=a.useCallback((s,B)=>{const M=setTimeout(s,B);return m.current.push(M),M},[]),q=a.useCallback(s=>s.gameOver||s.gameWon,[]),H=a.useCallback(s=>({completed:s.gameWon,score:s.score,level:s.level,pattern:s.pattern}),[]);Me(e,q,{onComplete:Q,gameSlug:"simonle",trackStats:!0,getResult:H});const G=a.useCallback((s,B)=>Y(null,null,function*(){if(!d.current)return;g(C=>P(v({},C),{isPlaying:!0,showPattern:!0}));const M=Math.max(800,1200-B*20),j=Math.max(200,400-B*10);for(let C=0;C<s.length;C++){if(!d.current||(g(x=>P(v({},x),{activeButton:s[C]})),yield new Promise(x=>{N(x,M)}),!d.current))return;g(x=>P(v({},x),{activeButton:null})),yield new Promise(x=>{N(x,j)})}d.current&&g(C=>P(v({},C),{isPlaying:!1,showPattern:!1,isUserTurn:!0,currentIndex:0,userPattern:[]}))}),[g,N]),V=a.useCallback(s=>{if(!e.isUserTurn||e.isPlaying)return;const B=[...e.userPattern,s];g(j=>P(v({},j),{userPattern:B,activeButton:s}));const M=e.pattern[B.length-1];if(s!==M){N(()=>{d.current&&g(j=>P(v({},j),{gameOver:!0,isUserTurn:!1,activeButton:null}))},300);return}if(N(()=>{d.current&&g(j=>P(v({},j),{activeButton:null}))},300),B.length===e.pattern.length){const j=e.score+e.level*10,C=e.level+1;if(C>e.maxLevel)g(x=>P(v({},x),{gameWon:!0,score:j,level:C,isUserTurn:!1}));else{const x=l?A(c,C):D(C);g(Z=>P(v({},Z),{score:j,level:C,pattern:x,userPattern:[],currentIndex:0,isUserTurn:!1})),N(()=>{d.current&&G(x,C)},1e3)}}},[e.isUserTurn,e.isPlaying,e.pattern,e.score,e.level,e.maxLevel,e.userPattern,l,c,g,G,N]);function Q(s){_(!0),$({won:s.gameWon,message:s.gameWon?z[I]:J[Math.floor(Math.random()*J.length)]}),s.gameWon&&h(M=>(M+1)%z.length);const B=P(v({},p),{gamesPlayed:p.gamesPlayed+1,gamesWon:s.gameWon?p.gamesWon+1:p.gamesWon,currentStreak:s.gameWon?p.currentStreak+1:0,bestStreak:s.gameWon?Math.max(p.bestStreak,p.currentStreak+1):p.bestStreak,bestScore:Math.max(p.bestScore,s.score),bestLevel:Math.max(p.bestLevel,s.level)});T(B),oe(B),l&&s.gameWon&&K("simonle",{date:u,completed:!0,result:{score:s.score,level:s.level}})}const L=a.useCallback(()=>{R();const s=l?A(c,1):D(1);w(P(v({},F),{pattern:s})),_(!1)},[R,l,c,w]),O=a.useCallback(()=>{!e.isPlaying&&!e.isUserTurn&&!e.gameOver&&!e.gameWon&&G(e.pattern,e.level)},[e.isPlaying,e.isUserTurn,e.gameOver,e.gameWon,e.pattern,e.level,G]);a.useEffect(()=>{!e.gameOver&&!e.gameWon&&!e.isPlaying&&!e.isUserTurn&&O()},[e.gameOver,e.gameWon,e.isPlaying,e.isUserTurn,O]),a.useEffect(()=>()=>{d.current=!1,R()},[R]);const X=()=>e.gameOver?e.gameWon?`Congratulations! You won the game with a score of ${e.score}!`:`Game over. You reached level ${e.level} with a score of ${e.score}`:e.isPlaying?`Watching pattern sequence, level ${e.level}`:e.isUserTurn?`Your turn! Repeat the pattern. You've entered ${e.userPattern.length} of ${e.pattern.length} colors`:`Level ${e.level}, score ${e.score}`;return o.jsxs(ue,{children:[o.jsx(S,{}),o.jsxs("div",{className:f.gameContainer,role:"application","aria-label":"Simonle game","aria-live":"polite","aria-atomic":"true",children:[o.jsx("div",{className:"sr-only","aria-live":"polite",children:X()}),o.jsxs("div",{className:f.gameInfo,children:[o.jsxs("div",{className:f.scoreDisplay,children:[o.jsxs("span",{children:["Score: ",e.score]}),o.jsxs("span",{children:["Level: ",e.level]})]}),l&&o.jsx("div",{className:f.dailyMode,children:"Daily Challenge"})]}),o.jsxs("div",{className:f.gameBoard,children:[e.isPlaying&&o.jsx("div",{className:f.patternIndicator,children:o.jsx("span",{children:"Watching pattern..."})}),o.jsx("div",{className:f.colorGrid,children:Ie.map(s=>o.jsx("button",{className:`${f.colorButton} ${e.activeButton===s.id?f.active:""} ${e.isUserTurn&&!e.isPlaying?f.clickable:""} ${e.isPlaying?f.patternPlayback:""}`,style:{backgroundColor:s.color,borderColor:s.borderColor},onClick:()=>V(s.id),disabled:!e.isUserTurn||e.isPlaying,"aria-label":`${s.name} button`,"aria-pressed":e.activeButton===s.id},s.id))})]}),o.jsxs("div",{className:f.gameControls,children:[!e.isPlaying&&!e.isUserTurn&&!e.gameOver&&!e.gameWon&&o.jsx("button",{className:f.startButton,onClick:O,"aria-label":"Start game",children:"Start Game"}),(e.gameOver||e.gameWon)&&o.jsx("button",{className:f.playAgainButton,onClick:L,"aria-label":"Play again",children:"Play Again"})]})]}),b&&o.jsx(de,{open:b,onClose:()=>_(!1),title:W.won?"Congratulations!":"Game Over",children:o.jsxs("div",{className:f.modalContent,children:[o.jsx("p",{children:W.message}),o.jsxs("div",{className:f.stats,children:[o.jsxs("p",{children:["Final Score: ",e.score]}),o.jsxs("p",{children:["Level Reached: ",e.level]})]}),o.jsxs("div",{className:f.modalButtons,children:[o.jsx("button",{onClick:L,children:"Play Again"}),o.jsx("button",{onClick:()=>i("/"),children:"Back to Games"})]})]})})]})};export{Ee as default};
