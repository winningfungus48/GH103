var A=Object.defineProperty,G=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var S=(u,l,r)=>l in u?A(u,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[l]=r,g=(u,l)=>{for(var r in l||(l={}))E.call(l,r)&&S(u,r,l[r]);if(P)for(var r of P(l))V.call(l,r)&&S(u,r,l[r]);return u},C=(u,l)=>G(u,W(l));import{j as a,o as I,p as T}from"./index-ChlTwkeS.js";import{u as Y,r as _}from"./router-vendor-K3Txs3ma.js";import{u as D,G as H}from"./useWelcomeModal-BE67pmST.js";import{u as q}from"./useDailySeed-BCululcd.js";import{M as z}from"./Modal-BytEiDWw.js";import"./react-vendor-C0DUGSOM.js";import"./helmet-vendor-DAr0CUAT.js";import"./index-C9qaKABp.js";const F="_container_3v658_1",J="_board_3v658_21",K="_row_3v658_43",Q="_tile_3v658_55",U="_current_3v658_127",X="_colorName_3v658_137",Z="_message_3v658_151",ee="_colorPadContainer_3v658_169",ae="_colorPad_3v658_169",te="_colorBtn_3v658_197",se="_actionButtons_3v658_293",oe="_actionBtn_3v658_305",re="_active_3v658_357",ne="_stats_3v658_387",le="_stat_3v658_387",ce="_statValue_3v658_415",ie="_statLabel_3v658_429",ue="_playAgainBtn_3v658_443",me="_closeBtn_3v658_479",t={container:F,board:J,row:K,tile:Q,current:U,colorName:X,message:Z,colorPadContainer:ee,colorPad:ae,colorBtn:te,actionButtons:se,actionBtn:oe,active:re,stats:ne,stat:le,statValue:ce,statLabel:ie,playAgainBtn:ue,closeBtn:me},B={secretColors:[],currentRow:0,currentCol:0,gameOver:!1,gameWon:!1,maxAttempts:6,colorLength:4,board:Array.from({length:6},()=>Array.from({length:4},()=>({color:"",status:""}))),colorPadColors:{}},x=[{name:"Red",value:"#ff0000",label:"Red"},{name:"Blue",value:"#0000ff",label:"Blue"},{name:"Green",value:"#00ff00",label:"Green"},{name:"Yellow",value:"#ffff00",label:"Yellow"},{name:"Purple",value:"#800080",label:"Purple"},{name:"Orange",value:"#ffa500",label:"Orange"},{name:"Pink",value:"#ffc0cb",label:"Pink"},{name:"Cyan",value:"#00ffff",label:"Cyan"}],y=["Colorful Victory!","Spectrum Success!","Rainbow Win!","Hue Got It!","Chromatic Champion!","Palette Perfect!","Color Master!","Spectrum Star!"];function de(u){const l=(()=>{let e=u;return()=>(e=(e*9301+49297)%233280,e/233280)})(),r=[];for(let e=0;e<4;e++){const c=Math.floor(l()*x.length);r.push(x[c])}return r}function he(u,l){const r=[],e=[...l],c=[...u];for(let n=0;n<c.length;n++)c[n]&&e[n]&&c[n].name===e[n].name&&(r.push({color:c[n],status:"correct"}),e[n]=null,c[n]=null);for(let n=0;n<c.length;n++)if(c[n]){const b=e.findIndex(f=>f&&f.name===c[n].name);b!==-1?(r.push({color:c[n],status:"present"}),e[b]=null):r.push({color:c[n],status:"absent"})}return r}const Ne=({instructions:u})=>{const l=Y(),r=q(),[e,c]=_.useState(B),[n,b]=_.useState(""),[f,p]=_.useState(!1),[d,w]=_.useState({}),{WelcomeModal:k}=D("Colorle",u);_.useEffect(()=>{if(r!==null){const s=de(r);c(o=>C(g({},o),{secretColors:s}))}},[r]);const R=s=>{e.gameOver||e.currentCol>=e.colorLength||c(o=>{const i=[...o.board];return i[o.currentRow][o.currentCol]={color:s,status:""},C(g({},o),{board:i,currentCol:o.currentCol+1})})},L=()=>{e.currentCol!==0&&c(s=>{const o=[...s.board];return o[s.currentRow][s.currentCol-1]={color:"",status:""},C(g({},s),{board:o,currentCol:s.currentCol-1})})},M=()=>{if(e.currentCol!==e.colorLength)return;const s=e.board[e.currentRow].map(m=>m.color).filter(Boolean);if(s.length!==e.colorLength)return;const o=he(s,e.secretColors),i=[...e.board];i[e.currentRow]=o;const h=o.every(m=>m.status==="correct"),v=h||e.currentRow===e.maxAttempts-1,N=g({},e.colorPadColors);o.forEach(m=>{m.color&&(N[m.color.name]=m.status)}),c(m=>C(g({},m),{board:i,currentRow:m.currentRow+1,currentCol:0,gameOver:v,gameWon:h,colorPadColors:N})),v&&$(h)},$=s=>{const o=I(),i=C(g({},o),{gamesPlayed:o.gamesPlayed+1,gamesWon:o.gamesWon+(s?1:0),currentStreak:s?o.currentStreak+1:0,maxStreak:s?Math.max(o.maxStreak,o.currentStreak+1):o.maxStreak});T(i);const h=y[Math.floor(Math.random()*y.length)];w({title:s?h:"Game Over",message:s?`You found the color pattern in ${e.currentRow+1} tries!`:`The pattern was: ${e.secretColors.map(v=>v.name).join(", ")}`,stats:i}),p(!0)},j=()=>{p(!1),l("/")},O=()=>{p(!1),c(B),b("")};return a.jsxs(H,{children:[a.jsxs("div",{className:t.container,children:[a.jsx("div",{className:t.board,role:"grid","aria-label":"Colorle game board",children:e.board.map((s,o)=>a.jsx("div",{className:`${t.row} ${o===e.currentRow?t.current:""}`,role:"row","aria-label":`Row ${o+1}`,children:s.map((i,h)=>a.jsx("div",{className:`${t.tile} ${i.status} ${o===e.currentRow&&h===e.currentCol?t.current:""}`,role:"gridcell","aria-label":`Position ${h+1}, ${i.color?i.color.name:"empty"}`,style:i.color?{backgroundColor:i.color.value}:{},tabIndex:0,children:i.color&&a.jsx("span",{className:t.colorName,children:i.color.name})},h))},o))}),n&&a.jsx("div",{className:t.message,role:"alert","aria-live":"assertive",children:n}),a.jsxs("div",{className:t.colorPadContainer,children:[a.jsx("div",{className:t.colorPad,role:"group","aria-label":"Color pad",children:x.map(s=>a.jsx("button",{className:`${t.colorBtn} ${e.colorPadColors[s.name]||""}`,onClick:()=>R(s),disabled:e.gameOver,"aria-label":`Select ${s.name}`,style:{backgroundColor:s.value},tabIndex:0,children:a.jsx("span",{className:t.colorName,children:s.name})},s.name))}),a.jsxs("div",{className:t.actionButtons,role:"group","aria-label":"Action buttons",children:[a.jsx("button",{className:t.actionBtn,onClick:L,disabled:e.gameOver,"aria-label":"Delete last color",tabIndex:0,children:"âŒ«"}),a.jsx("button",{className:`${t.actionBtn} ${e.currentCol===e.colorLength?t.active:""}`,onClick:M,disabled:e.gameOver||e.currentCol!==e.colorLength,"aria-label":"Submit guess",tabIndex:0,children:"Enter"})]})]})]}),a.jsxs(z,{open:f,onClose:j,title:d.title,children:[a.jsx("p",{children:d.message}),d.stats&&a.jsxs("div",{className:t.stats,children:[a.jsxs("div",{className:t.stat,children:[a.jsx("span",{className:t.statValue,children:d.stats.gamesPlayed}),a.jsx("span",{className:t.statLabel,children:"Games"})]}),a.jsxs("div",{className:t.stat,children:[a.jsxs("span",{className:t.statValue,children:[d.stats.gamesPlayed>0?Math.round(d.stats.gamesWon/d.stats.gamesPlayed*100):0,"%"]}),a.jsx("span",{className:t.statLabel,children:"Win Rate"})]}),a.jsxs("div",{className:t.stat,children:[a.jsx("span",{className:t.statValue,children:d.stats.currentStreak}),a.jsx("span",{className:t.statLabel,children:"Current Streak"})]}),a.jsxs("div",{className:t.stat,children:[a.jsx("span",{className:t.statValue,children:d.stats.maxStreak}),a.jsx("span",{className:t.statLabel,children:"Max Streak"})]})]}),a.jsxs("div",{slot:"buttons",children:[a.jsx("button",{onClick:O,className:t.playAgainBtn,children:"Play Again"}),a.jsx("button",{onClick:j,className:t.closeBtn,children:"Close"})]})]}),a.jsx(k,{})]})};export{Ne as default};
