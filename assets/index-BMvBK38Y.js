var E=Object.defineProperty,Y=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var P=(c,o,l)=>o in c?E(c,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[o]=l,p=(c,o)=>{for(var l in o||(o={}))T.call(o,l)&&P(c,l,o[l]);if(b)for(var l of b(o))z.call(o,l)&&P(c,l,o[l]);return c},u=(c,o)=>Y(c,D(o));import{j as a,v as K,w as q}from"./index-Dz65CAxN.js";import{d as H,r as _}from"./router-vendor-BfUoC7-o.js";import{u as J,G as Q,M as U}from"./useWelcomeModal-CPqjDDpd.js";import{u as X}from"./useDailySeed-CCpBxUz8.js";import"./react-vendor-C0DUGSOM.js";import"./helmet-vendor-CTOi22zu.js";import"./index-C9qaKABp.js";const Z="_container_84nra_1",ss="_gameContainer_84nra_73",as="_grid_84nra_91",es="_card_84nra_109",ts="_cardInner_84nra_145",ns="_flipped_84nra_165",rs="_cardFront_84nra_173",ls="_cardBack_84nra_175",os="_matched_84nra_229",cs="_controls_84nra_241",is="_resetBtn_84nra_263",ds="_moves_84nra_319",ms="_pairs_84nra_321",hs="_stats_84nra_335",ps="_stat_84nra_335",us="_statValue_84nra_363",Ms="_statLabel_84nra_377",vs="_playAgainBtn_84nra_391",gs="_closeBtn_84nra_427",e={container:Z,gameContainer:ss,grid:as,card:es,cardInner:ts,flipped:ns,cardFront:rs,cardBack:ls,matched:os,controls:cs,resetBtn:is,moves:ds,pairs:ms,stats:hs,stat:ps,statValue:us,statLabel:Ms,playAgainBtn:vs,closeBtn:gs},S={cards:[],flippedCards:[],matchedPairs:[],gameOver:!1,gameWon:!1,maxMoves:30,currentMoves:0,gridSize:4,totalPairs:8},k=["ðŸŽ®","ðŸŽ²","ðŸŽ¯","ðŸŽª","ðŸŽ¨","ðŸŽ­","ðŸŽª","ðŸŽ¯","ðŸŽ²","ðŸŽ®","ðŸŽ¨","ðŸŽ­","ðŸŽª","ðŸŽ¯","ðŸŽ²","ðŸŽ®"],B=["Memory Master!","Card Champion!","Match Maker!","Recall Royalty!","Memory Wizard!","Pair Pro!","Match Master!","Memory Ace!"];function L(c){const o=(()=>{let r=c;return()=>(r=(r*9301+49297)%233280,r/233280)})(),l=[];for(let r=0;r<8;r++)l.push(k[r],k[r]);const s=[...l];for(let r=s.length-1;r>0;r--){const v=Math.floor(o()*(r+1));[s[r],s[v]]=[s[v],s[r]]}return s.map((r,v)=>({id:v,symbol:r,isFlipped:!1,isMatched:!1}))}const Ps=({instructions:c})=>{const o=H(),l=X(),[s,r]=_.useState(S),[v,F]=_.useState(""),[W,x]=_.useState(!1),[d,$]=_.useState({}),{WelcomeModal:O}=J("Memoryle",c);_.useEffect(()=>{if(l!==null){const t=L(l);r(n=>u(p({},n),{cards:t}))}},[l]);const j=t=>{if(s.gameOver||s.flippedCards.length>=2)return;const n=s.cards.find(i=>i.id===t);if(!n||n.isFlipped||n.isMatched)return;const h=s.cards.map(i=>i.id===t?u(p({},i),{isFlipped:!0}):i),M=[...s.flippedCards,t];r(i=>u(p({},i),{cards:h,flippedCards:M})),M.length===2&&setTimeout(()=>{w(M)},1e3)},w=t=>{const[n,h]=t.map(m=>s.cards.find(V=>V.id===m)),M=n.symbol===h.symbol,i=s.currentMoves+1;let g=[...s.cards],f=[...s.matchedPairs];M?(g=g.map(m=>t.includes(m.id)?u(p({},m),{isMatched:!0}):m),f.push(n.symbol)):g=g.map(m=>t.includes(m.id)?u(p({},m),{isFlipped:!1}):m);const y=f.length===s.totalPairs,N=y||i>=s.maxMoves;r(m=>u(p({},m),{cards:g,flippedCards:[],matchedPairs:f,currentMoves:i,gameOver:N,gameWon:y})),N&&G(y)},A=t=>{if(s.gameOver||s.flippedCards.length>=2)return;const h={1:0,2:1,3:2,4:3,5:4,6:5,7:6,8:7,9:8,0:9,q:10,w:11,e:12,r:13,t:14,y:15}[t.key.toLowerCase()];h!==void 0&&h<s.cards.length&&j(h)},G=t=>{const n=K(),h=u(p({},n),{gamesPlayed:n.gamesPlayed+1,gamesWon:n.gamesWon+(t?1:0),currentStreak:t?n.currentStreak+1:0,maxStreak:t?Math.max(n.maxStreak,n.currentStreak+1):n.maxStreak,totalMoves:n.totalMoves+s.currentMoves,bestMoves:t?Math.min(n.bestMoves||1/0,s.currentMoves):n.bestMoves});q(h);const M=B[Math.floor(Math.random()*B.length)],i=t?`You found all pairs in ${s.currentMoves} moves!`:`Game over. You found ${s.matchedPairs.length} pairs in ${s.currentMoves} moves.`;$({title:t?M:"Game Over",message:i,stats:h}),x(!0)},C=()=>{x(!1),o("/")},I=()=>{x(!1),r(S),F("")},R=()=>{if(l!==null){const t=L(l);r(n=>u(p({},n),{cards:t,flippedCards:[],matchedPairs:[],currentMoves:0,gameOver:!1,gameWon:!1}))}};return a.jsxs(Q,{children:[a.jsxs("div",{className:e.container,onKeyDown:A,tabIndex:0,role:"application","aria-label":"Memoryle game","aria-live":"polite","aria-atomic":"true",children:[a.jsx("div",{className:"sr-only","aria-live":"polite",children:s.gameOver?s.gameWon?"Congratulations! You found all pairs!":`Game over. You found ${s.matchedPairs.length} pairs.`:`Moves: ${s.currentMoves} of ${s.maxMoves}, ${s.matchedPairs.length} pairs found`}),a.jsx("div",{className:e.gameContainer,children:a.jsx("div",{className:e.grid,role:"grid","aria-label":"Memory card grid",children:s.cards.map((t,n)=>a.jsx("div",{className:`${e.card} ${t.isFlipped||t.isMatched?e.flipped:""} ${t.isMatched?e.matched:""}`,onClick:()=>j(t.id),role:"gridcell","aria-label":`Card ${n+1}, ${t.isFlipped||t.isMatched?t.symbol:"hidden"}`,tabIndex:0,children:a.jsxs("div",{className:e.cardInner,children:[a.jsx("div",{className:e.cardFront,children:"?"}),a.jsx("div",{className:e.cardBack,children:t.symbol})]})},t.id))})}),a.jsxs("div",{className:e.controls,children:[a.jsx("button",{className:e.resetBtn,onClick:R,disabled:s.gameOver,"aria-label":"Reset game",tabIndex:0,children:"Reset"}),a.jsxs("div",{className:e.moves,children:["Moves: ",s.currentMoves,"/",s.maxMoves]}),a.jsxs("div",{className:e.pairs,children:["Pairs: ",s.matchedPairs.length,"/",s.totalPairs]})]})]}),a.jsxs(U,{open:W,onClose:C,title:d.title,children:[a.jsx("p",{children:d.message}),d.stats&&a.jsxs("div",{className:e.stats,children:[a.jsxs("div",{className:e.stat,children:[a.jsx("span",{className:e.statValue,children:d.stats.gamesPlayed}),a.jsx("span",{className:e.statLabel,children:"Games"})]}),a.jsxs("div",{className:e.stat,children:[a.jsxs("span",{className:e.statValue,children:[d.stats.gamesPlayed>0?Math.round(d.stats.gamesWon/d.stats.gamesPlayed*100):0,"%"]}),a.jsx("span",{className:e.statLabel,children:"Win Rate"})]}),a.jsxs("div",{className:e.stat,children:[a.jsx("span",{className:e.statValue,children:d.stats.currentStreak}),a.jsx("span",{className:e.statLabel,children:"Current Streak"})]}),a.jsxs("div",{className:e.stat,children:[a.jsx("span",{className:e.statValue,children:d.stats.maxStreak}),a.jsx("span",{className:e.statLabel,children:"Max Streak"})]}),d.stats.bestMoves&&a.jsxs("div",{className:e.stat,children:[a.jsx("span",{className:e.statValue,children:d.stats.bestMoves}),a.jsx("span",{className:e.statLabel,children:"Best Moves"})]})]}),a.jsxs("div",{slot:"buttons",children:[a.jsx("button",{onClick:I,className:e.playAgainBtn,children:"Play Again"}),a.jsx("button",{onClick:C,className:e.closeBtn,children:"Close"})]})]}),a.jsx(O,{})]})};export{Ps as default};
