var X=Object.defineProperty,Z=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var G=(o,s,l)=>s in o?X(o,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[s]=l,u=(o,s)=>{for(var l in s||(s={}))te.call(s,l)&&G(o,l,s[l]);if(P)for(var l of P(s))ae.call(s,l)&&G(o,l,s[l]);return o},b=(o,s)=>Z(o,ee(s));import{g as re,j as r,c as ne,d as se}from"./index-CYVwgDTc.js";import{u as oe,e as le,r as p}from"./router-vendor-K3Txs3ma.js";import{u as ce,G as ie}from"./useWelcomeModal-Q3ReE-fg.js";import{u as me}from"./useDailySeed-BCululcd.js";import{M as ue}from"./Modal-BkFHXk8f.js";import"./react-vendor-C0DUGSOM.js";import"./helmet-vendor-DAr0CUAT.js";import"./index-C9qaKABp.js";const E={secretNumber:"",currentRow:0,currentCol:0,gameOver:!1,gameWon:!1,maxAttempts:6,numberLength:5,board:Array.from({length:6},()=>Array.from({length:5},()=>({value:"",status:""}))),keypadColors:{}},L=["Great Job!","Awesome!","You did it!","Impressive!","Fantastic!","Well done!","You cracked it!","Brilliant!","Superb!","You nailed it!"];function B(){return Math.floor(Math.random()*1e5).toString().padStart(5,"0")}function D(){return Array.from({length:6},()=>Array.from({length:5},()=>({value:"",status:""})))}function w(o){function s(N){let h=0;for(let d=0;d<N.length;d++)h=(h<<5)-h+N.charCodeAt(d),h|=0;let v=Math.abs(h)/2147483647;return()=>(v=Math.sin(v*1e4)*1e4,v-Math.floor(v))}const l=s(o);return Math.floor(l()*1e5).toString().padStart(5,"0")}function de(o){return/^\d{5}$/.test(o)}const xe=({mode:o,description:s,instructions:l})=>{const N=oe(),h=le(),d=new URLSearchParams(h.search).get("mode")==="daily",S=new Date().toISOString().slice(0,10),f=me({date:S,slug:"numberle"}),[e,y]=p.useState(()=>{const t=d&&f?w(f):B();return b(u({},E),{secretNumber:t,board:D()})}),[g,I]=p.useState(()=>re()),[T,x]=p.useState(!1),[Y,_]=p.useState({won:!1,message:""}),[j,C]=p.useState(""),[K,F]=p.useState(0),{gameContainerRef:U}=ce("Numberle",l);p.useEffect(()=>{d&&f&&e.secretNumber!==w(f)&&y(t=>b(u({},t),{secretNumber:w(f)}))},[d,f,e.secretNumber]);const R=t=>{if(e.gameOver||e.currentCol>=e.numberLength)return;const n=[...e.board];n[e.currentRow][e.currentCol]={value:t,status:"filled"},y(b(u({},e),{board:n,currentCol:e.currentCol+1}))},W=()=>{if(e.gameOver||e.currentCol===0)return;const t=[...e.board];t[e.currentRow][e.currentCol-1]={value:"",status:""},y(b(u({},e),{board:t,currentCol:e.currentCol-1}))},M=()=>{if(e.gameOver||e.currentCol!==e.numberLength)return;const t=e.board[e.currentRow].map(m=>m.value).join("");if(!de(t)){C("Please enter a valid 5-digit number");return}const n=H(t,e.secretNumber),c=[...e.board];for(let m=0;m<e.numberLength;m++)c[e.currentRow][m]=b(u({},c[e.currentRow][m]),{status:n[m]});const i=u({},e.keypadColors);for(let m=0;m<e.numberLength;m++){const $=t[m],O=n[m];(!i[$]||O==="correct")&&(i[$]=O)}const a=t===e.secretNumber,k=a||e.currentRow===e.maxAttempts-1,A=b(u({},e),{board:c,currentRow:k?e.currentRow:e.currentRow+1,currentCol:0,gameOver:k,gameWon:a,keypadColors:i});y(A),C(""),k&&q(A)},q=t=>{x(!0),_({won:t.gameWon,message:t.gameWon?L[K]:`Game Over! The number was ${t.secretNumber}`}),F(c=>(c+1)%L.length);const n=b(u({},g),{gamesPlayed:g.gamesPlayed+1,gamesWon:t.gameWon?g.gamesWon+1:g.gamesWon,currentStreak:t.gameWon?g.currentStreak+1:0,bestStreak:t.gameWon?Math.max(g.bestStreak,g.currentStreak+1):g.bestStreak});I(n),ne(n),d&&t.gameWon&&se("numberle",{date:S,completed:!0,result:{}})},J=()=>{y(b(u({},E),{secretNumber:d?w(f):B(),board:D()})),x(!1),C("")},V=()=>{x(!1)},z=t=>{e.gameOver||(t.key>="0"&&t.key<="9"?R(t.key):t.key==="Enter"?M():t.key==="Backspace"&&W())},H=(t,n)=>{const c=Array(5).fill("absent"),i={};for(let a=0;a<5;a++)i[n[a]]=(i[n[a]]||0)+1;for(let a=0;a<5;a++)t[a]===n[a]&&(c[a]="correct",i[t[a]]--);for(let a=0;a<5;a++)c[a]!=="correct"&&i[t[a]]>0&&(c[a]="present",i[t[a]]--);return c},Q=()=>e.gameOver?e.gameWon?"Congratulations! You won the game!":`Game over. The number was ${e.secretNumber}`:`Attempt ${e.currentRow+1} of ${e.maxAttempts}, ${e.currentCol} digits entered`;return r.jsxs(ie,{children:[r.jsxs("div",{className:"game-container",ref:U,onKeyDown:z,tabIndex:0,role:"application","aria-label":"Numberle game","aria-live":"polite","aria-atomic":"true",style:{outline:"2px solid transparent"},onFocus:t=>t.target.style.outline="2px solid #007bff",onBlur:t=>t.target.style.outline="2px solid transparent",children:[r.jsx("div",{className:"sr-only","aria-live":"polite",children:Q()}),r.jsx("div",{className:"board",role:"grid","aria-label":"Numberle game board",children:e.board.map((t,n)=>r.jsx("div",{className:`row ${n===e.currentRow?"current":""}`,role:"row","aria-label":`Row ${n+1}`,children:t.map((c,i)=>r.jsx("div",{className:`tile ${c.status} ${n===e.currentRow&&i===e.currentCol?"current":""}`,role:"gridcell","aria-label":`Position ${i+1}, ${c.value||"empty"}`,tabIndex:0,children:c.value},i))},n))}),j&&r.jsx("div",{className:"message",role:"alert","aria-live":"assertive",children:j}),r.jsxs("div",{className:"keypad-container",children:[r.jsx("div",{className:"number-row",role:"group","aria-label":"Number keys",children:[1,2,3,4,5,6,7,8,9,0].map(t=>r.jsx("button",{className:`key-btn number-btn ${e.keypadColors[t]||""}`,onClick:()=>R(t.toString()),disabled:e.gameOver,"aria-label":`Enter digit ${t}`,tabIndex:0,children:t},t))}),r.jsxs("div",{className:"action-row",role:"group","aria-label":"Action keys",children:[r.jsx("button",{className:"key-btn action-btn",onClick:W,disabled:e.gameOver,"aria-label":"Delete last digit",tabIndex:0,children:"âŒ«"}),r.jsx("button",{className:`key-btn action-btn ${e.currentCol===e.numberLength?"active":""}`,onClick:M,disabled:e.gameOver||e.currentCol!==e.numberLength,"aria-label":"Submit number",tabIndex:0,children:"Enter"})]})]})]}),r.jsx(ue,{open:T,onClose:V,title:e.gameWon?"Congratulations!":"Game Over",className:"endgame-modal",buttons:r.jsxs("div",{className:"endgame-buttons",children:[r.jsx("button",{className:"playagain-btn",onClick:J,"aria-label":"Play again",children:"Play Again"}),r.jsx("button",{className:"backhome-btn",onClick:()=>N("/"),"aria-label":"Back to games",children:"Back to Games"})]}),children:r.jsxs("div",{className:"endgame-content",children:[r.jsx("p",{className:"endgame-message",children:Y.message}),!e.gameWon&&r.jsxs("p",{className:"endgame-equation",children:["The number was: ",e.secretNumber]})]})})]})};export{xe as default};
